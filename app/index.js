"use strict";!function(){var e=window.Marzipano,t=window.bowser,i=window.screenfull,n=window.APP_DATA,a=document.querySelector("#pano"),o=document.querySelector("#titleBar .sceneName"),s=document.querySelector("#sceneList"),r=document.querySelectorAll("#sceneList .scene"),l=document.querySelector("#sceneListToggle"),c=document.querySelector("#autorotateToggle"),d=document.querySelector("#fullscreenToggle");if(window.matchMedia){var p=function(){g.matches?(document.body.classList.remove("desktop"),document.body.classList.add("mobile")):(document.body.classList.remove("mobile"),document.body.classList.add("desktop"))},g=matchMedia("(max-width: 500px), (max-height: 500px)");p(),g.addListener(p)}else document.body.classList.add("desktop");document.body.classList.add("no-touch"),window.addEventListener("touchstart",function(){document.body.classList.remove("no-touch"),document.body.classList.add("touch")}),document.getElementById("tooltips").addEventListener("click",function(e){e.preventDefault();var t=document.querySelectorAll(".link-hotspot-tooltip"),i=document.querySelectorAll(".info-hotspot-title-wrapper");t.forEach(function(e){e.classList.toggle("active")}),i.forEach(function(e){e.classList.toggle("active")})}),document.getElementById("offInfo").addEventListener("click",function(e){e.preventDefault(),document.querySelectorAll(".hotspot.info-hotspot").forEach(function(e){var t=parseFloat(window.getComputedStyle(e).opacity);e.style.opacity=0===t?"1":"0"})}),document.getElementById("offLink").addEventListener("click",function(e){e.preventDefault(),document.querySelectorAll(".hotspot.link-hotspot").forEach(function(e){var t=parseFloat(window.getComputedStyle(e).opacity);e.style.opacity=0===t?"1":"0"})}),document.getElementById("initialView").addEventListener("click",function(e){e.preventDefault(),m.view.setParameters(m.data.initialViewParameters),m.scene.switchTo()}),document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("languageButton"),t=document.getElementById("languageDropdown");e.addEventListener("click",function(){t.classList.toggle("show"),event.stopPropagation()}),document.getElementById("language-select").addEventListener("change",function(){changeLanguage(),t.classList.remove("show")}),document.addEventListener("click",function(e){var t=document.getElementById("languageButton"),i=document.getElementById("languageDropdown");e.target===t||i.contains(e.target)||i.classList.remove("show")})}),t.msie&&11>parseFloat(t.version)&&document.body.classList.add("tooltip-fallback");var h={controls:{mouseViewMode:n.settings.mouseViewMode}},u=new e.Viewer(a,h),f=n.scenes.map(function(t){var i="tiles",n=e.ImageUrlSource.fromString(i+"/"+t.id+"/{z}/{f}/{y}/{x}.jpg",{cubeMapPreviewUrl:i+"/"+t.id+"/preview.jpg"});"24-cafeteria-1"===t.id&&(n=e.ImageUrlSource.fromString(i+"/23-dining-hall/{z}/{f}/{y}/{x}.jpg",{cubeMapPreviewUrl:i+"/23-dining-hall/preview.jpg"})),"3-4-entrepreneurship"===t.id&&(n=e.ImageUrlSource.fromString(i+"/6-building-blocks-3--4/{z}/{f}/{y}/{x}.jpg",{cubeMapPreviewUrl:i+"/6-building-blocks-3--4/preview.jpg"})),"3-4-incubator"===t.id&&(n=e.ImageUrlSource.fromString(i+"/6-building-blocks-3--4/{z}/{f}/{y}/{x}.jpg",{cubeMapPreviewUrl:i+"/6-building-blocks-3--4/preview.jpg"})),"8-medic2"===t.id&&(n=e.ImageUrlSource.fromString(i+"/8-library-of-sciences--technology/{z}/{f}/{y}/{x}.jpg",{cubeMapPreviewUrl:i+"/8-library-of-sciences--technology/preview.jpg"})),"8-ai"===t.id&&(n=e.ImageUrlSource.fromString(i+"/8-library-of-sciences--technology/{z}/{f}/{y}/{x}.jpg",{cubeMapPreviewUrl:i+"/8-library-of-sciences--technology/preview.jpg"})),"5-labs"===t.id&&(n=e.ImageUrlSource.fromString(i+"/71-/{z}/{f}/{y}/{x}.jpg",{cubeMapPreviewUrl:i+"/71-/preview.jpg"}));var a=new e.CubeGeometry(t.levels),o=e.RectilinearView.limit.traditional(t.faceSize,100*Math.PI/180,120*Math.PI/180),s=new e.RectilinearView(t.initialViewParameters,o);if(t.flatFile&&t.flatFile.isflatFile){var r=t.levels.map(e=>({width:e.size,height:e.size,tileWidth:e.tileSize,tileHeight:e.tileSize}));a=new e.FlatGeometry(r),o=e.util.compose(e.FlatView.limit.resolution(t.flatFile.width),e.FlatView.limit.letterbox()),s=new e.FlatView({mediaAspectRatio:t.flatFile.width/t.flatFile.height},o),n=e.ImageUrlSource.fromString(i+"/"+t.id+"/"+t.id+".jpg",{cubeMapPreviewUrl:i+"/"+t.id+"/preview.jpg"})}var l=u.createScene({source:n,geometry:a,view:s,pinFirstLevel:!0});return t.linkHotspots.forEach(function(t){var i=function e(t){var i=document.createElement("div");i.classList.add("hotspot"),i.classList.add("link-hotspot");var n=document.createElement("div");n.classList.add("link-inner-wrapper");var a=document.createElement("span");a.innerHTML=x(t.target).name,n.appendChild(a);var o=document.createElement("img");o.src="img/link.png",o.classList.add("link-hotspot-icon"),n.appendChild(o);for(var s=["-ms-transform","-webkit-transform","transform"],r=0;r<s.length;r++){var l=s[r];n.style[l]="rotate("+t.rotation+"rad)"}i.addEventListener("click",function(){M(P(t.target))}),H(i);var c=document.createElement("div");return c.classList.add("hotspot-tooltip"),c.classList.add("link-hotspot-tooltip"),c.innerHTML=x(t.target).name,i.appendChild(n),i.appendChild(c),i}(t),n=l.view();n&&n instanceof e.FlatView?l.hotspotContainer().createHotspot(i,{x:t.yaw,y:t.pitch}):l.hotspotContainer().createHotspot(i,{yaw:t.yaw,pitch:t.pitch})}),t.infoHotspots.forEach(function(t){var i=l.view(),n=function e(t){var i=document.createElement("div");i.classList.add("hotspot"),i.classList.add("info-hotspot");var n=document.createElement("div");n.classList.add("info-hotspot-header");var a=document.createElement("div");a.classList.add("info-hotspot-icon-wrapper");var o=document.createElement("img");switch(t.infoType){case"help":o.src="img/help.png";break;case"warning":o.src="img/warning.png";break;case"stop":o.src="img/stop.png";break;case"location":o.src="img/location.png";break;case"shopping":o.src="img/shopping.png";break;case"contacts":o.src="img/contacts.png";break;case"video":o.src="img/video.png";break;case"webpage":o.src="img/webpage.png";break;default:o.src="img/info.png"}o.classList.add("info-hotspot-icon"),a.appendChild(o);var s=document.createElement("div");s.classList.add("info-hotspot-title-wrapper");var r=document.createElement("div");r.classList.add("info-hotspot-title"),r.innerHTML=t.title,s.appendChild(r);var l=document.createElement("div");l.classList.add("info-hotspot-close-wrapper");var c=document.createElement("img");c.src="img/close.png",c.classList.add("info-hotspot-close-icon"),l.appendChild(c),n.appendChild(a),n.appendChild(s),n.appendChild(l);var d=document.createElement("div");d.classList.add("info-hotspot-text"),d.innerHTML=t.text,i.appendChild(n),i.appendChild(d);var p=document.createElement("div");p.innerHTML=i.innerHTML,p.classList.add("info-hotspot-modal"),document.body.appendChild(p);var g=function(){i.classList.toggle("visible"),p.classList.toggle("visible")};return i.querySelector(".info-hotspot-header").addEventListener("click",g),p.querySelector(".info-hotspot-close-wrapper").addEventListener("click",g),H(i),i}(t);i&&i instanceof e.FlatView?l.hotspotContainer().createHotspot(n,{x:t.yaw,y:t.pitch}):l.hotspotContainer().createHotspot(n,{yaw:t.yaw,pitch:t.pitch})}),{data:t,scene:l,view:s}}),m=f[0],v=e.autorotate({yawSpeed:.03,targetPitch:0,targetFov:Math.PI/2});n.settings.autorotateEnabled&&c.classList.add("enabled"),c.addEventListener("click",function e(){c.classList.contains("enabled")?(c.classList.remove("enabled"),T()):(c.classList.add("enabled"),I())}),i.enabled&&n.settings.fullscreenButton?(document.body.classList.add("fullscreen-enabled"),d.addEventListener("click",function(){i.toggle()}),i.on("change",function(){i.isFullscreen?d.classList.add("enabled"):d.classList.remove("enabled")})):document.body.classList.add("fullscreen-disabled"),l.addEventListener("click",function e(){s.classList.toggle("enabled"),l.classList.toggle("enabled")}),document.body.classList.contains("mobile")||(s.classList.add("enabled"),l.classList.add("enabled")),f.forEach(function(e){document.querySelector('#sceneList .scene[data-id="'+e.data.id+'"]').addEventListener("click",function(){M(e),document.body.classList.contains("mobile")&&(s.classList.remove("enabled"),l.classList.remove("enabled"))})});var w=document.querySelector("#viewUp"),y=document.querySelector("#viewDown"),L=document.querySelector("#viewLeft"),b=document.querySelector("#viewRight"),E=document.querySelector("#viewIn"),k=document.querySelector("#viewOut"),S=u.controls();function M(e){T(),e.view.setParameters(e.data.initialViewParameters),e.scene.switchTo(),I(),C(e),$(e),m=e}function C(e){var t;o.innerHTML=(t=e.data.name).replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")}function $(e){for(var t=0;t<r.length;t++){var i=r[t];i.getAttribute("data-id")===e.data.id?i.classList.add("current"):i.classList.remove("current")}}function I(){c.classList.contains("enabled")&&(u.startMovement(v),u.setIdleMovement(3e3,v))}function T(){u.stopMovement(),u.setIdleMovement(1/0)}function H(e,t){for(var t=["touchstart","touchmove","touchend","touchcancel","wheel","mousewheel"],i=0;i<t.length;i++)e.addEventListener(t[i],function(e){e.stopPropagation()})}function P(e){for(var t=0;t<f.length;t++)if(f[t].data.id===e)return f[t];return null}function x(e){for(var t=0;t<n.scenes.length;t++)if(n.scenes[t].id===e)return n.scenes[t];return null}S.registerMethod("upElement",new e.ElementPressControlMethod(w,"y",-.7,3),!0),S.registerMethod("downElement",new e.ElementPressControlMethod(y,"y",.7,3),!0),S.registerMethod("leftElement",new e.ElementPressControlMethod(L,"x",-.7,3),!0),S.registerMethod("rightElement",new e.ElementPressControlMethod(b,"x",.7,3),!0),S.registerMethod("inElement",new e.ElementPressControlMethod(E,"zoom",-.7,3),!0),S.registerMethod("outElement",new e.ElementPressControlMethod(k,"zoom",.7,3),!0);var B=!1,q=!1;function A(){document.getElementById("hotspotModal").style.display="none"}function U(e,t){var i,n,a=P(e),o={yaw:t.yaw,pitch:t.pitch,fov:Math.PI/2};i=a,n=o,T(),i.view.setParameters(n),i.scene.switchTo(),I(),C(i),$(i),m=i,A()}var j=document.getElementById("searchInput");let _=document.getElementById("clearSearch");function z(e){e.forEach(function(e){B=!0,q=!0,e.infoHotspots.forEach(function(t){(function e(t,i){var n=document.getElementById("infohotspotTable"),a="";switch(t.infoType){case"help":a="img/help.png";break;case"warning":a="img/warning.png";break;case"stop":a="img/stop.png";break;case"location":a="img/location.png";break;case"shopping":a="img/shopping.png";break;case"contacts":a="img/contacts.png";break;case"video":a="img/video.png";break;case"webpage":a="img/webpage.png";break;default:a="img/info44.png"}var o=n.insertRow();if(B){var s=o.insertCell();s.innerHTML=i.name,s.rowSpan=i.infoHotspots.length,B=!1}var r=o.insertCell(),l=o.insertCell(),c=o.insertCell(),d=o.insertCell(),p=o.insertCell();r.innerHTML='<img src="img/info44.png" alt="Info}" width="35px" height="35px">',c.innerHTML=`<img src="${a}" alt="info" width="35px" height="35px">`,l.innerHTML=t.title,d.innerHTML=t.text;let g=document.createElement("a");g.setAttribute("href","#");let h=document.createElement("img");h.setAttribute("src","img/go.png"),h.setAttribute("width","35"),h.setAttribute("height","35"),g.appendChild(h),g.addEventListener("click",function(e){e.preventDefault(),U(i.id,t)}),p.appendChild(g)})(t,e,B)}),e.linkHotspots.forEach(function(t){(function e(t,i){var n=document.getElementById("linkhotspotTable").insertRow();if(q){var a=n.insertCell();a.innerHTML=i.name,a.rowSpan=i.linkHotspots.length,q=!1}var o=n.insertCell(),s=n.insertCell(),r=n.insertCell();o.innerHTML='<img src="img/link.png" alt="${hotspot.title}" width="35px" height="35px">',s.innerHTML=t.target;let l=document.createElement("a");l.setAttribute("href","#");let c=document.createElement("img");c.setAttribute("src","img/go.png"),c.setAttribute("width","35"),c.setAttribute("height","35"),l.appendChild(c),l.addEventListener("click",function(e){e.preventDefault(),U(i.id,t)}),r.appendChild(l)})(t,e,q)})})}function F(e){document.getElementById("linkhotspotTable").innerHTML=`<thead>
          <tr>
            <th>Scene Name</th>
            <th>Hotspot Type</th>
            <th>Target</th>           
           
            <th>Action</th>
          </tr>
        </thead>`,document.getElementById("infohotspotTable").innerHTML=` <thead>
          <tr>
            <th>Scene Name</th>
            <th>Hotspot Type</th>
            <th>Title</th>
            <th>Info Type</th>
			<th>Text </th>	
          
            <th>Action</th>
          </tr>`;var t=function e(t,i){let n=t.scenes.filter(e=>{let t=e.infoHotspots.some(e=>e.title&&e.title.toLowerCase().includes(i)||e.text&&e.text.toLowerCase().includes(i)||e.type&&e.type.toLowerCase().includes(i))||e.linkHotspots.some(e=>e.target&&e.target.toLowerCase().includes(i));return t});return n}(n,e);t||(t=n.scenes),z(t)}z(n.scenes),j.addEventListener("input",function(e){_.style.display=this.value?"inline-block":"none",F(e.target.value)}),_.addEventListener("click",function(){j.value="",this.style.display="none",F(j.value)}),document.getElementById("findHotspot").addEventListener("click",function(e){e.preventDefault(),document.getElementById("hotspotModal").style.display="block"}),document.getElementById("closeSearchHotspot").addEventListener("click",function(e){e.preventDefault(),A()}),M(f[0])}();